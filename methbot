#!/usr/bin/env ruby

require 'rubygems'
require 'eventmachine'
puts "EventMachine Loaded"

ROOT=File.dirname(__FILE__)+"/.."
puts "ROOT set to '#{ROOT}'"

require "#{ROOT}/lib/meth_bot.rb"
puts "MethBot Loaded"

EM.epoll
EM.run {
  begin
    (server,port) = MethBot.server.split(':')
    puts "Connecting MethBot to #{server.to_s}:#{port.to_s}"
    EM::connect(server, port.to_i, handler)
  rescue
    puts "Error: #{$!}"
    $@.each do |line| puts "#{line}" end
  end
}

