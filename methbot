#!/usr/bin/env ruby

require 'rubygems'
require 'eventmachine'
puts "EventMachine Loaded"

ROOT=File.dirname(__FILE__)
puts "ROOT set to '#{ROOT}'"

require "#{ROOT}/lib/meth_bot.rb"
puts "MethBot Loaded"

EM.epoll
EM.run {
  begin
    puts "Connecting MethBot to #{MethBot.server}:#{MethBot.port.to_s}"
    EM::connect(MethBot.server, MethBot.port, MethBot)
  rescue
    puts "Error: #{$!}"
    $@.each do |line| puts "#{line}" end
  end
}

