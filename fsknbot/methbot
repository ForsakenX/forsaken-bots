#!/usr/bin/env ruby

=begin
Globals
=end

ROOT  = File.dirname(__FILE__)

=begin
Load Path
=end

$: << "#{ROOT}/lib/"

=begin
Main Libs
=end

require 'rubygems'
require 'eventmachine'
require 'logger'
require 'yaml'

require "meth/meth.rb"

Dir[
  "#{ROOT}/lib/*.rb",
  "#{ROOT}/lib/*.so",
  "#{ROOT}/models/*.rb",
].each { |m| require m if FileTest.executable?(m) }

CONFIG = YAML.load(File.open("#{ROOT}/conf/settings.yaml"))


=begin
Run
=end

EM::run {
  begin
    EM::connect(CONFIG['server'],CONFIG['port'],Meth::Bot)
  rescue
    puts "#{$!}\n#{$@.join("\n")}"
    exit 1
  end
}

