#!/usr/bin/env ruby


=begin
Main Libs
=end

require 'rubygems'
require 'eventmachine'
require 'logger'
require 'yaml'

=begin
Globals
=end

ROOT  = File.dirname(__FILE__)

CONFIG = YAML.load(File.open("#{ROOT}/conf/settings.yaml"))

LOGGER = Logger.new("#{ROOT}/logs/client")
LOGGER.level = Logger.const_get(CONFIG['logger']['severity'])

=begin
Application Libs
=end

$: << "#{ROOT}/lib/"

Dir[
  "#{ROOT}/lib/*.rb",
  "#{ROOT}/models/*.rb",
].each { |m| require m if FileTest.executable?(m) }

require "irc/irc.rb"

=begin
Run
=end

EM::run {
  begin
    EM::connect(CONFIG['server'],CONFIG['port'],Irc::Client)
  rescue
    puts "#{$!}\n#{$@.join("\n")}"
    exit 1
  end
}

